**The boost1.67 or boost1.70 environment needs to be configured for Windows or Linux**

## 1. Introduction

The molecular docking program Koto is based on a new method--gradient boosting differential evolution algorithm as the search strategy. Meanwhile,  the scoring function used by koto is the same as Vina, it's simpler but faster to search. This guide describes how to use Autodock-Koto for molecular docking and use AutoDockTools(https://ccsb.scripps.edu/mgltools/downloads/) to generate related files and to analyze results. The following steps are semi-flexible docking processes for a protein and a ligand. Here we assume that you've got the original protein and the small molecule to dock with from the relevant database. 


## 2.Preparing PDBQT files

### Receptor file

Open the downloaded receptor in AutoDockTools (If the prepared receptor file format that is not supported by AutoDockTools, you can use OpenBabel to convert it)，perform the following operations on the receptor：

- Delete metal ions (You can do this with pymol)
- Delete water
- Add hydrogen atoms（all hydrogens not polar hydrogens）

When you're done, save the file in PDBQT format.

### Ligand file

Open the downloaded ligand file in AutoDockTools (If the prepared ligand file format that is not supported by AutoDockTools, you can also use OpenBabel to convert it). For ligands, simply hydrogenate and store them in PDBQT format. 

To process receptors and ligand files, you can also use scripts in AutoDockTools—prepare_receptor4.py and prepare_ligand4.py, operate directly from the command line. For example： 

- ./pythonsh prepare_receptor4.py -r [receptor file name] -A ‘hydrogens’
- /pythonsh prepare_ligand4.py -l [ligand file name] -A ‘hydrogens’

More details can be found on the website https://autodock.scripps.edu/

### Configuration file

After processing the receptor file and ligand file, we need to add configuration files to describe some parameters related to the docking process and docking results before docking. Related parameter details：

```
Input:
receptor 			receptor file name(PDBQT)
ligand 				ligand file name(PDBQT)
target(optional)	(if any)already docked conformation (PDBQT)

Search space (required):
center_x   			X coordinate of the grid box center 
center_y			Y coordinate of the grid box center
center_z			Z coordinate of the grid box center 
size_x   			grid box size in the X dimension (Angstroms)  
size_y   			grid box size in the Y dimension (Angstroms)
size_z				grid box size in the Z dimension (Angstroms)

Output (optional):
out					output file(PDBQT format), If not specified, the default is 					chosen based on the ligand name 
log					Information output at the terminal, write log

Others (optional)
cpu					the number of CPUs to use (the default is to try to detect 						the number of CPUs or, failing that, use 1)	
exhaustiveness   	exhaustiveness of the global search (the default is 8
num_modes			maximum number of docking conformations produced 
					(the default is 9) 
energy_range		maximum energy difference between the best binding mode 					and the worst one(the default is 3.0) 
```

The relevant parameters of search space are generated in AutoDockTools, if ligand is extracted from a known protein complex, the grid box can be directly determined according to ligand. Otherwise, the size of the grid box can be set according to the active site of the protein. It is worth mentioning that If the parameter marked optional is not specified, program will use the default value. Here is an example of a configuration file in Koto/config_picture. 

## 3. Docking and Analysis

### For Windows

Put the receptor, ligand, config files and the executable files of the docking program in the same folder, and run the following command on the terminal：

- koto.exe --config [config file name]

### For Linux

Put the receptor, ligand, config files and the executable files of the docking program in the same folder, and run the following command on the terminal： 

- ./koto --config [config file name]

Wait until the docking is complete，the program will sort the conformations from small to large according to the docking binding energy and terminal output each conformation’s information. Meanwhile all conformations generated by program are written together in one file, you can open the result file in AutoDockTools to see its structure. 